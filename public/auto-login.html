<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è‡ªåŠ¨ç™»å½• - è¶…åä½“ç®¡ç†åå°</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .container {
      text-align: center;
      max-width: 500px;
      padding: 40px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 2rem;
    }

    .step {
      background: rgba(255, 255, 255, 0.2);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      text-align: left;
    }

    .step h3 {
      margin-bottom: 10px;
      color: #ffd93d;
    }

    .credentials {
      background: rgba(0, 0, 0, 0.3);
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      margin: 10px 0;
    }

    .button {
      display: inline-block;
      padding: 15px 40px;
      background: white;
      color: #667eea;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      margin: 10px;
      transition: all 0.3s;
      border: none;
      cursor: pointer;
      font-size: 1rem;
    }

    .button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .button-secondary {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 2px solid white;
    }

    .status {
      margin: 20px 0;
      padding: 15px;
      border-radius: 8px;
      display: none;
    }

    .status.success {
      background: rgba(16, 185, 129, 0.3);
      border: 2px solid #10b981;
      display: block;
    }

    .status.error {
      background: rgba(239, 68, 68, 0.3);
      border: 2px solid #ef4444;
      display: block;
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸš€ å¿«é€Ÿç™»å½•ç®¡ç†åå°</h1>

    <div class="step">
      <h3>ğŸ“ æ–¹å¼1ï¼šä½¿ç”¨æµ‹è¯•è´¦å·ï¼ˆæ¨èï¼‰</h3>
      <div class="credentials">
        ğŸ“§ é‚®ç®±ï¼šadmin@test.com<br>
        ğŸ”‘ å¯†ç ï¼š123456
      </div>
      <button class="button" onclick="quickLogin()">ä¸€é”®ç™»å½•å¹¶è·³è½¬</button>
    </div>

    <div class="step">
      <h3>ğŸ†• æ–¹å¼2ï¼šåˆ›å»ºæ–°ç®¡ç†å‘˜è´¦å·</h3>
      <p style="margin: 10px 0; font-size: 0.9rem;">å¦‚æœæµ‹è¯•è´¦å·æ— æ³•ç™»å½•ï¼Œç‚¹å‡»ä¸‹æ–¹æ³¨å†Œ</p>
      <button class="button button-secondary" onclick="goToRegister()">å‰å¾€æ³¨å†Œ</button>
    </div>

    <div class="step">
      <h3>ğŸ”§ æ–¹å¼3ï¼šç›´æ¥è®¿é—®ç®¡ç†åå°</h3>
      <p style="margin: 10px 0; font-size: 0.9rem;">å¦‚æœæ‚¨å·²ç™»å½•ï¼Œå¯ç›´æ¥è®¿é—®</p>
      <button class="button button-secondary" onclick="goToAdmin()">æ‰“å¼€ç®¡ç†åå°</button>
    </div>

    <div id="status" class="status"></div>

    <p style="margin-top: 30px; opacity: 0.8; font-size: 0.9rem;">
      ğŸ’¡ æç¤ºï¼šç¬¬ä¸€ä¸ªæ³¨å†Œçš„ç”¨æˆ·è‡ªåŠ¨æˆä¸ºç®¡ç†å‘˜
    </p>
  </div>

  <script>
    const API_BASE = window.location.origin;

    async function quickLogin() {
      const statusEl = document.getElementById('status');
      statusEl.className = 'status';
      statusEl.innerHTML = '<div class="loading"></div> æ­£åœ¨ç™»å½•...';
      statusEl.classList.add('success');

      try {
        // å°è¯•ç™»å½•
        const response = await fetch(`${API_BASE}/api/auth/login`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            email: 'admin@test.com',
            password: '123456'
          })
        });

        const data = await response.json();

        if (data.success && data.token) {
          // ä¿å­˜token
          localStorage.setItem('token', data.token);
          localStorage.setItem('user', JSON.stringify(data.user));

          statusEl.innerHTML = 'âœ… ç™»å½•æˆåŠŸï¼æ­£åœ¨è·³è½¬åˆ°ç®¡ç†åå°...';

          // å»¶è¿Ÿ1ç§’åè·³è½¬
          setTimeout(() => {
            window.location.href = '/admin.html';
          }, 1000);
        } else {
          // ç™»å½•å¤±è´¥ï¼Œå¯èƒ½æ˜¯è´¦å·ä¸å­˜åœ¨
          statusEl.className = 'status error';
          statusEl.innerHTML = `âŒ ${data.message || 'ç™»å½•å¤±è´¥'}<br><br>è¯·ç‚¹å‡»ã€Œå‰å¾€æ³¨å†Œã€åˆ›å»ºè´¦å·`;
        }
      } catch (error) {
        statusEl.className = 'status error';
        statusEl.innerHTML = `âŒ ç½‘ç»œé”™è¯¯ï¼š${error.message}<br><br>è¯·ç¡®ä¿æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ`;
      }
    }

    function goToRegister() {
      window.location.href = '/register.html';
    }

    function goToAdmin() {
      const token = localStorage.getItem('token');

      if (!token) {
        const statusEl = document.getElementById('status');
        statusEl.className = 'status error';
        statusEl.innerHTML = 'âŒ æ‚¨è¿˜æœªç™»å½•ï¼Œè¯·å…ˆä½¿ç”¨ä¸Šæ–¹çš„ç™»å½•æŒ‰é’®';
        return;
      }

      window.location.href = '/admin.html';
    }

    // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
    window.addEventListener('load', () => {
      const token = localStorage.getItem('token');
      if (token) {
        const statusEl = document.getElementById('status');
        statusEl.className = 'status success';
        statusEl.innerHTML = 'âœ… æ£€æµ‹åˆ°æ‚¨å·²ç™»å½•ï¼å¯ä»¥ç›´æ¥è®¿é—®ç®¡ç†åå°';
      }
    });
  </script>
</body>
</html>
