<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶…åçŸ­é‚® - äº¤äº’åŸå‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            background: #0f0f23;
            color: #fff;
            overflow: hidden;
            height: 100vh;
        }

        /* Container */
        .app-container {
            max-width: 430px;
            height: 100vh;
            margin: 0 auto;
            background: linear-gradient(135deg, #16213e 0%, #0f0f23 100%);
            position: relative;
            overflow: hidden;
        }

        /* Header */
        .app-header {
            padding: 60px 20px 20px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .header-title {
            font-size: 32px;
            font-weight: 900;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .header-subtitle {
            font-size: 14px;
            color: #888;
        }

        /* Inbox */
        .inbox {
            padding: 20px;
            height: calc(100vh - 200px);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .mail-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .mail-card::before {
            content: '';
            position: absolute;
            left: -100%;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s;
        }

        .mail-card:active::before {
            left: 100%;
        }

        .mail-card:active {
            transform: scale(0.98);
        }

        .mail-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .mail-icon {
            font-size: 28px;
        }

        .mail-title {
            font-size: 17px;
            font-weight: 600;
            flex: 1;
        }

        .mail-badge {
            background: linear-gradient(135deg, #f59e0b 0%, #dc2626 100%);
            padding: 4px 10px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 700;
        }

        .mail-meta {
            font-size: 13px;
            color: #888;
            margin-bottom: 10px;
        }

        .mail-action {
            font-size: 15px;
            color: #667eea;
            margin-bottom: 10px;
        }

        .mail-attachments {
            font-size: 12px;
            color: #666;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .attachment-badge {
            background: rgba(102, 126, 234, 0.2);
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
        }

        /* Compose Button */
        .compose-btn {
            position: fixed;
            bottom: 30px;
            right: calc(50% - 195px);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            cursor: pointer;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.6);
            transition: all 0.3s;
            z-index: 100;
            user-select: none;
            border: none;
            color: white;
        }

        .compose-btn:active {
            transform: scale(0.9);
        }

        .compose-btn.pressed {
            width: 100px;
            height: 100px;
            bottom: calc(50% - 50px);
            right: calc(50% - 50px);
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.8);
        }

        /* Compose Modal */
        .compose-modal {
            position: fixed;
            bottom: -100%;
            left: 0;
            width: 100%;
            height: 70%;
            background: rgba(22, 33, 62, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 30px 30px 0 0;
            transition: bottom 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 200;
            box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.5);
        }

        .compose-modal.active {
            bottom: 0;
        }

        .compose-handle {
            width: 40px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            margin: 12px auto;
        }

        .compose-content {
            padding: 20px;
            height: calc(100% - 80px);
            overflow-y: auto;
        }

        .compose-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
        }

        /* AI Guide */
        .ai-guide {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .ai-avatar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .ai-avatar-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .ai-name {
            font-size: 14px;
            font-weight: 600;
            color: #667eea;
        }

        .ai-question {
            font-size: 18px;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .ai-typing {
            display: none;
            align-items: center;
            gap: 5px;
            color: #888;
            font-size: 14px;
        }

        .ai-typing.active {
            display: flex;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
            animation: typing 1.4s ease-in-out infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.5;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }

        /* Voice Input */
        .voice-input {
            background: rgba(255, 255, 255, 0.05);
            border: 2px dashed rgba(102, 126, 234, 0.5);
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .voice-input.recording {
            background: rgba(102, 126, 234, 0.2);
            border-style: solid;
            border-color: #667eea;
        }

        .voice-icon {
            font-size: 60px;
            margin-bottom: 15px;
            display: inline-block;
            transition: all 0.3s;
        }

        .voice-input.recording .voice-icon {
            animation: pulse-voice 1s ease-in-out infinite;
        }

        @keyframes pulse-voice {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .voice-text {
            font-size: 16px;
            color: #888;
        }

        .voice-input.recording .voice-text {
            color: #667eea;
            font-weight: 600;
        }

        .voice-result {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
            font-size: 15px;
            line-height: 1.6;
            display: none;
        }

        .voice-result.active {
            display: block;
            animation: slideInUp 0.3s ease-out;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .quick-action {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-action:active {
            transform: scale(0.95);
            background: rgba(102, 126, 234, 0.2);
        }

        .quick-action-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .quick-action-label {
            font-size: 12px;
            color: #888;
        }

        /* Preview Card */
        .preview-card {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(102, 126, 234, 0.5);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            display: none;
        }

        .preview-card.active {
            display: block;
            animation: slideInUp 0.4s ease-out;
        }

        .preview-header {
            font-size: 14px;
            color: #667eea;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .preview-subject {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .preview-action-type {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 14px;
            margin-bottom: 15px;
            display: inline-block;
        }

        .preview-content {
            font-size: 15px;
            line-height: 1.6;
            color: #e0e0e0;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .preview-attachments {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .preview-attachment {
            background: rgba(102, 126, 234, 0.2);
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .preview-ai-insight {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            padding: 15px;
            font-size: 14px;
            line-height: 1.6;
        }

        .preview-ai-label {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 8px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 16px;
            border-radius: 15px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:active {
            transform: scale(0.95);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .btn-secondary:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.2);
        }

        /* Detail Modal */
        .detail-modal {
            position: fixed;
            top: 100%;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0f0f23;
            transition: top 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 300;
            overflow-y: auto;
        }

        .detail-modal.active {
            top: 0;
        }

        .detail-header {
            padding: 60px 20px 20px;
            background: rgba(0, 0, 0, 0.3);
            position: sticky;
            top: 0;
            backdrop-filter: blur(10px);
            z-index: 10;
        }

        .detail-back {
            font-size: 24px;
            cursor: pointer;
            margin-bottom: 15px;
            display: inline-block;
        }

        .detail-content {
            padding: 20px;
        }

        .detail-subject {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .detail-meta-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .detail-meta-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 10px;
            font-size: 13px;
        }

        .detail-meta-label {
            color: #888;
            margin-bottom: 5px;
        }

        .detail-meta-value {
            color: #fff;
            font-weight: 600;
        }

        .detail-section {
            margin-bottom: 30px;
        }

        .detail-section-title {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-text {
            font-size: 16px;
            line-height: 1.8;
            color: #e0e0e0;
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
        }

        .attachment-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .attachment-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .attachment-item:active {
            background: rgba(102, 126, 234, 0.2);
            transform: scale(0.98);
        }

        .attachment-icon {
            font-size: 32px;
        }

        .attachment-info {
            flex: 1;
        }

        .attachment-name {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .attachment-desc {
            font-size: 13px;
            color: #888;
        }

        /* Success Animation */
        .success-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 200px;
            height: 200px;
            background: rgba(16, 185, 129, 0.9);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .success-animation.active {
            transform: translate(-50%, -50%) scale(1);
        }

        .success-icon {
            font-size: 80px;
            margin-bottom: 10px;
        }

        .success-text {
            font-size: 18px;
            font-weight: 600;
        }

        /* Haptic Feedback Visual */
        @keyframes haptic {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
        }

        /* Gesture Hints */
        .gesture-hint {
            position: fixed;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 12px 20px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 50;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .gesture-hint.active {
            opacity: 1;
        }

        /* Swipe Actions */
        .mail-card {
            touch-action: pan-y;
        }

        .swipe-actions {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            display: flex;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .swipe-action {
            width: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .swipe-action.reply {
            background: #10b981;
        }

        .swipe-action.archive {
            background: #6366f1;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="app-header">
            <div class="header-title">ğŸ“¬ æ”¶ä»¶ç®±</div>
            <div class="header-subtitle">è¶…åçŸ­é‚® Â· è‰¯æ¸šèŠ‚ç‚¹</div>
        </div>

        <!-- Inbox -->
        <div class="inbox" id="inbox">
            <div class="mail-card" data-id="1">
                <div class="mail-header">
                    <span class="mail-icon">ğŸ’</span>
                    <span class="mail-title">ç§¯åˆ†æ–¹æ¡ˆé€‰æ‹©</span>
                    <span class="mail-badge">é«˜ä»·å€¼</span>
                </div>
                <div class="mail-meta">ğŸ‘¤ äº§å“ç»ç†èŠ‚ç‚¹ â€¢ â±ï¸ 20åˆ†é’Ÿå‰</div>
                <div class="mail-action">ğŸ¯ éœ€è¦ä½ é€‰æ‹©æ–¹æ¡ˆAæˆ–B</div>
                <div class="mail-attachments">
                    <span class="attachment-badge">ğŸ“ äº§å“æµç¨‹å›¾</span>
                    <span class="attachment-badge">ğŸ¤ è¯­éŸ³è¯´æ˜ 2'30"</span>
                    <span class="attachment-badge">ğŸ“Š æ•°æ®åˆ†æ.xlsx</span>
                </div>
            </div>

            <div class="mail-card" data-id="2">
                <div class="mail-header">
                    <span class="mail-icon">ğŸ“Š</span>
                    <span class="mail-title">æœ¬å‘¨è¿›åº¦æ±‡æŠ¥</span>
                </div>
                <div class="mail-meta">ğŸ‘¤ è¿è¥èŠ‚ç‚¹ â€¢ â±ï¸ 1å°æ—¶å‰</div>
                <div class="mail-action">ğŸ“‹ é¡¹ç›®è¿›å±•æ›´æ–°</div>
                <div class="mail-attachments">
                    <span class="attachment-badge">ğŸ¬ æ•°æ®é¢æ¿å½•å±</span>
                    <span class="attachment-badge">ğŸ¤– AI: ç”¨æˆ·å¢é•¿30%</span>
                </div>
            </div>

            <div class="mail-card" data-id="3">
                <div class="mail-header">
                    <span class="mail-icon">â“</span>
                    <span class="mail-title">æŠ€æœ¯éš¾é¢˜æ±‚åŠ©</span>
                </div>
                <div class="mail-meta">ğŸ‘¤ æŠ€æœ¯èŠ‚ç‚¹ â€¢ â±ï¸ 3å°æ—¶å‰</div>
                <div class="mail-action">ğŸ†˜ APIè°ƒç”¨æŠ¥é”™</div>
                <div class="mail-attachments">
                    <span class="attachment-badge">ğŸ“· æŠ¥é”™æˆªå›¾</span>
                    <span class="attachment-badge">ğŸ¤– å·²å…³è”å†å²æ™¶ä½“</span>
                </div>
            </div>
        </div>

        <!-- Compose Button -->
        <button class="compose-btn" id="composeBtn">+</button>

        <!-- Gesture Hint -->
        <div class="gesture-hint" id="gestureHint">é•¿æŒ‰å‘èµ·çŸ­é‚®</div>

        <!-- Compose Modal -->
        <div class="compose-modal" id="composeModal">
            <div class="compose-handle"></div>
            <div class="compose-close" id="closeCompose">Ã—</div>

            <div class="compose-content" id="composeContent">
                <!-- Step 1: AI Guide -->
                <div class="ai-guide" id="aiGuide">
                    <div class="ai-avatar">
                        <div class="ai-avatar-icon">ğŸ¤–</div>
                        <div class="ai-name">AIåä½œåŠ©æ‰‹</div>
                    </div>
                    <div class="ai-question" id="aiQuestion">
                        è¿™æ¬¡çŸ­é‚®å…³äºä»€ä¹ˆï¼Ÿ
                    </div>
                    <div class="ai-typing" id="aiTyping">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <span style="margin-left: 5px;">AIæ­£åœ¨æ€è€ƒ...</span>
                    </div>
                </div>

                <!-- Voice Input -->
                <div class="voice-input" id="voiceInput">
                    <div class="voice-icon">ğŸ¤</div>
                    <div class="voice-text" id="voiceText">ç‚¹å‡»å¼€å§‹è¯´è¯</div>
                    <div class="voice-result" id="voiceResult"></div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <div class="quick-action" data-action="photo">
                        <div class="quick-action-icon">ğŸ“·</div>
                        <div class="quick-action-label">æ‹ç…§</div>
                    </div>
                    <div class="quick-action" data-action="file">
                        <div class="quick-action-icon">ğŸ“</div>
                        <div class="quick-action-label">æ–‡ä»¶</div>
                    </div>
                    <div class="quick-action" data-action="scan">
                        <div class="quick-action-icon">ğŸ“„</div>
                        <div class="quick-action-label">æ‰«æ</div>
                    </div>
                </div>

                <!-- Preview Card -->
                <div class="preview-card" id="previewCard">
                    <div class="preview-header">ğŸ¤– AIä¸ºä½ æ„å»ºçš„çŸ­é‚®é¢„è§ˆ</div>

                    <div class="preview-subject">
                        <span>ğŸ“Œ</span>
                        <span id="previewSubject">ç§¯åˆ†æ–¹æ¡ˆè®¨è®º</span>
                    </div>

                    <div class="preview-action-type" id="previewActionType">
                        ğŸ¯ éœ€è¦å†³ç­–
                    </div>

                    <div class="preview-content" id="previewContent">
                        æˆ‘ä»¬éœ€è¦åœ¨ç§¯åˆ†æ–¹æ¡ˆAå’ŒBä¸­é€‰ä¸€ä¸ªï¼ŒAæ–¹æ¡ˆæ›´æ³¨é‡é•¿æœŸæ¿€åŠ±ï¼ŒBæ–¹æ¡ˆæ›´çµæ´»...
                    </div>

                    <div class="preview-attachments" id="previewAttachments">
                        <div class="preview-attachment">
                            <span>ğŸ“·</span>
                            <span>äº§å“æµç¨‹å›¾</span>
                        </div>
                        <div class="preview-attachment">
                            <span>ğŸ¤</span>
                            <span>è¯­éŸ³è¯´æ˜ 2'30"</span>
                        </div>
                    </div>

                    <div class="preview-ai-insight">
                        <div class="preview-ai-label">ğŸ¤– AIæ´å¯Ÿ</div>
                        è¿™ä¸ªæ–¹æ¡ˆå ğŸ”ï¸ åœŸå±æ€§ï¼ˆé•¿æœŸä¸»ä¹‰ï¼‰ï¼Œé€‚åˆæ³¨é‡æŒç»­å‘å±•çš„å›¢é˜Ÿã€‚å»ºè®®å¼ºè°ƒé•¿æœŸä»·å€¼å’Œç¨³å®šæ€§ã€‚
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons" id="actionButtons" style="display: none;">
                    <button class="btn btn-secondary" id="editBtn">âœï¸ ä¿®æ”¹</button>
                    <button class="btn btn-primary" id="sendBtn">ğŸ“¤ å‘é€</button>
                </div>
            </div>
        </div>

        <!-- Detail Modal -->
        <div class="detail-modal" id="detailModal">
            <div class="detail-header">
                <div class="detail-back" id="detailBack">â† è¿”å›</div>
                <div class="header-subtitle">çŸ­é‚®è¯¦æƒ…</div>
            </div>

            <div class="detail-content" id="detailContent">
                <!-- Content will be dynamically inserted -->
            </div>
        </div>

        <!-- Success Animation -->
        <div class="success-animation" id="successAnimation">
            <div class="success-icon">âœ…</div>
            <div class="success-text">å‘é€æˆåŠŸ</div>
        </div>
    </div>

    <script>
        // State
        let isRecording = false;
        let longPressTimer = null;
        let currentStep = 1;
        let mailData = {
            subject: '',
            content: '',
            attachments: [],
            actionType: 'decision'
        };

        // Sample mail details
        const mailDetails = {
            '1': {
                icon: 'ğŸ’',
                subject: 'ç§¯åˆ†æ–¹æ¡ˆé€‰æ‹©',
                from: 'äº§å“ç»ç†èŠ‚ç‚¹',
                time: '20åˆ†é’Ÿå‰',
                actionType: 'éœ€è¦å†³ç­–',
                content: 'åŸºäºä¸Šæ¬¡ä¼šè®®è®¨è®ºï¼Œæˆ‘æ•´ç†äº†ä¸¤ä¸ªç§¯åˆ†åˆ†é…æ–¹æ¡ˆï¼š\n\næ–¹æ¡ˆAï¼ˆé•¿æœŸæ¿€åŠ±å‹ï¼‰ï¼š\n- 70%é•¿æœŸè´¡çŒ®ç§¯åˆ†\n- 30%çŸ­æœŸæ¿€åŠ±ç§¯åˆ†\n- é‡ç‚¹å¥–åŠ±æŒç»­è´¡çŒ®\n\næ–¹æ¡ˆBï¼ˆçµæ´»å¹³è¡¡å‹ï¼‰ï¼š\n- 50%ä»»åŠ¡å®Œæˆç§¯åˆ†\n- 30%è´¨é‡è¯„ä»·ç§¯åˆ†\n- 20%åˆ›æ–°å¥–åŠ±ç§¯åˆ†\n\nè¯·å›¢é˜Ÿå†³ç­–é€‰æ‹©å“ªä¸ªæ–¹æ¡ˆã€‚',
                attachments: [
                    { icon: 'ğŸ“·', name: 'äº§å“æµç¨‹å›¾', desc: 'AIè¯†åˆ«ï¼šå±•ç¤ºäº†ç§¯åˆ†è·å–çš„3æ¡è·¯å¾„' },
                    { icon: 'ğŸ¤', name: 'è¯­éŸ³è¯´æ˜', desc: '2åˆ†30ç§’ï¼Œå·²è½¬æ–‡å­—' },
                    { icon: 'ğŸ“Š', name: 'æ•°æ®åˆ†æ.xlsx', desc: 'AIæ‘˜è¦ï¼šç”¨æˆ·ç•™å­˜ç‡æå‡30%' }
                ],
                aiInsight: 'äº”è¡Œåˆ†æï¼šæ–¹æ¡ˆAåğŸ”ï¸åœŸå±æ€§ï¼ˆé•¿æœŸä¸»ä¹‰ï¼‰ï¼Œé€‚åˆæ³¨é‡æŒç»­å‘å±•ï¼›æ–¹æ¡ˆBåğŸ”¥ç«+ğŸŒŠæ°´ï¼Œæ›´çµæ´»ä½†éœ€è¦ç²¾ç»†è¿è¥ã€‚\n\nå»ºè®®ï¼šå¦‚æœå›¢é˜Ÿå¤„äºæˆé•¿æœŸï¼Œå»ºè®®æ–¹æ¡ˆAï¼›å¦‚æœéœ€è¦å¿«é€Ÿæ¿€æ´»ç”¨æˆ·ï¼Œå»ºè®®æ–¹æ¡ˆBã€‚'
            },
            '2': {
                icon: 'ğŸ“Š',
                subject: 'æœ¬å‘¨è¿›åº¦æ±‡æŠ¥',
                from: 'è¿è¥èŠ‚ç‚¹',
                time: '1å°æ—¶å‰',
                actionType: 'è¿›åº¦æ›´æ–°',
                content: 'æœ¬å‘¨é¡¹ç›®è¿›å±•æ±‡æŠ¥ï¼š\n\næ ¸å¿ƒæ•°æ®ï¼š\n- æ—¥æ´»ç”¨æˆ·ï¼š2,580äººï¼ˆâ†‘30%ï¼‰\n- æ–°å¢ç”¨æˆ·ï¼š450äººï¼ˆâ†‘25%ï¼‰\n- æ™¶ä½“æ•°é‡ï¼š127ä¸ªï¼ˆâ†‘15%ï¼‰\n- æ´»è·ƒé¡¹ç›®ï¼š23ä¸ªï¼ˆâ†‘40%ï¼‰\n\né‡ç‚¹æˆæœï¼š\n1. å®Œæˆç§¯åˆ†ç³»ç»Ÿv2.0å¼€å‘\n2. ä¸Šçº¿3ä¸ªæ–°é¡¹ç›®\n3. ç”¨æˆ·ç•™å­˜ç‡æå‡è‡³65%\n\nä¸‹å‘¨è®¡åˆ’ï¼š\n- ä¼˜åŒ–æ¨èç®—æ³•\n- ä¸¾åŠçº¿ä¸‹äº¤æµä¼š',
                attachments: [
                    { icon: 'ğŸ¬', name: 'æ•°æ®é¢æ¿å½•å±', desc: '30ç§’æ¼”ç¤ºï¼ŒAIå·²æå–å…³é”®æ•°æ®' }
                ],
                aiInsight: 'AIè¯†åˆ«åˆ°å…³é”®æŒ‡æ ‡éƒ½åœ¨ä¸Šå‡ï¼Œç‰¹åˆ«æ˜¯æ´»è·ƒé¡¹ç›®å¢é•¿40%è¯´æ˜é¡¹ç›®åˆ¶ç®¡ç†æ•ˆæœæ˜¾è‘—ã€‚å»ºè®®ç»§ç»­åŠ å¤§é¡¹ç›®åˆ›å»ºçš„å¼•å¯¼ã€‚'
            },
            '3': {
                icon: 'â“',
                subject: 'æŠ€æœ¯éš¾é¢˜æ±‚åŠ©',
                from: 'æŠ€æœ¯èŠ‚ç‚¹',
                time: '3å°æ—¶å‰',
                actionType: 'æŠ€æœ¯æ”¯æŒ',
                content: 'é‡åˆ°æŠ€æœ¯é—®é¢˜éœ€è¦æ”¯æŒï¼š\n\né—®é¢˜æè¿°ï¼š\nç”¨æˆ·ç™»å½•æ—¶å¶å°”å‡ºç°500é”™è¯¯ï¼Œä½†ä¸æ˜¯æ¯æ¬¡éƒ½å¤ç°ã€‚åˆæ­¥æ’æŸ¥æ˜¯æ•°æ®åº“è¿æ¥æ± çš„é—®é¢˜ã€‚\n\nå·²å°è¯•ï¼š\n- æ£€æŸ¥æ—¥å¿—ï¼Œå‘ç°é«˜å³°æœŸå‡ºç°\n- å¢åŠ è¿æ¥æ± å¤§å°ï¼Œæœªè§£å†³\n- æŸ¥çœ‹æœåŠ¡å™¨èµ„æºï¼Œæ­£å¸¸\n\néœ€è¦ï¼š\næŠ€æœ¯ä¸“å®¶å¸®å¿™åˆ†æï¼Œæ˜¯å¦æœ‰ç±»ä¼¼ç»éªŒï¼Ÿ',
                attachments: [
                    { icon: 'ğŸ“·', name: 'æŠ¥é”™æˆªå›¾', desc: 'Error 500: Database connection timeout' },
                    { icon: 'ğŸ“„', name: 'é”™è¯¯æ—¥å¿—', desc: 'server.log (æœ€è¿‘1å°æ—¶)' }
                ],
                aiInsight: 'AIå…³è”åˆ°å†å²æ™¶ä½“ä¸­æœ‰2ä¸ªç›¸ä¼¼é—®é¢˜ï¼š\n1. "é«˜å¹¶å‘ä¸‹çš„è¿æ¥æ± ä¼˜åŒ–" - å»ºè®®ä½¿ç”¨è¿æ¥æ± ç›‘æ§\n2. "æ•°æ®åº“æ…¢æŸ¥è¯¢æ’æŸ¥" - å¯èƒ½æ˜¯æŸä¸ªæŸ¥è¯¢å ç”¨è¿æ¥\n\nå»ºè®®ï¼šå…ˆæ£€æŸ¥æ˜¯å¦æœ‰æ…¢æŸ¥è¯¢ï¼Œç„¶åé…ç½®è¿æ¥æ± è¶…æ—¶å‘Šè­¦ã€‚'
            }
        };

        // Elements
        const composeBtn = document.getElementById('composeBtn');
        const composeModal = document.getElementById('composeModal');
        const closeCompose = document.getElementById('closeCompose');
        const voiceInput = document.getElementById('voiceInput');
        const voiceText = document.getElementById('voiceText');
        const voiceResult = document.getElementById('voiceResult');
        const aiQuestion = document.getElementById('aiQuestion');
        const aiTyping = document.getElementById('aiTyping');
        const previewCard = document.getElementById('previewCard');
        const actionButtons = document.getElementById('actionButtons');
        const gestureHint = document.getElementById('gestureHint');
        const successAnimation = document.getElementById('successAnimation');
        const detailModal = document.getElementById('detailModal');
        const detailBack = document.getElementById('detailBack');

        // Show gesture hint on load
        setTimeout(() => {
            gestureHint.classList.add('active');
            setTimeout(() => gestureHint.classList.remove('active'), 3000);
        }, 1000);

        // Long press to compose
        composeBtn.addEventListener('touchstart', (e) => {
            e.preventDefault();
            longPressTimer = setTimeout(() => {
                composeBtn.classList.add('pressed');
                startVoiceRecording();
                navigator.vibrate && navigator.vibrate(50);
            }, 500);
        });

        composeBtn.addEventListener('touchend', (e) => {
            e.preventDefault();
            clearTimeout(longPressTimer);
            if (composeBtn.classList.contains('pressed')) {
                stopVoiceRecording();
                composeBtn.classList.remove('pressed');
            } else {
                openComposeModal();
            }
        });

        composeBtn.addEventListener('click', (e) => {
            e.preventDefault();
            openComposeModal();
        });

        // Open compose modal
        function openComposeModal() {
            composeModal.classList.add('active');
            resetCompose();
        }

        // Close compose modal
        closeCompose.addEventListener('click', () => {
            composeModal.classList.remove('active');
        });

        // Reset compose state
        function resetCompose() {
            currentStep = 1;
            voiceInput.classList.remove('recording');
            voiceResult.classList.remove('active');
            previewCard.classList.remove('active');
            actionButtons.style.display = 'none';
            aiQuestion.textContent = 'è¿™æ¬¡çŸ­é‚®å…³äºä»€ä¹ˆï¼Ÿ';
            voiceText.textContent = 'ç‚¹å‡»å¼€å§‹è¯´è¯';
        }

        // Voice input
        voiceInput.addEventListener('click', () => {
            if (!isRecording) {
                startVoiceRecording();
            } else {
                stopVoiceRecording();
            }
        });

        function startVoiceRecording() {
            isRecording = true;
            voiceInput.classList.add('recording');
            voiceText.textContent = 'æ­£åœ¨å½•éŸ³...æ¾æ‰‹å®Œæˆ';
            gestureHint.textContent = 'ä¸Šæ»‘æ·»åŠ é™„ä»¶';
            gestureHint.classList.add('active');
            setTimeout(() => gestureHint.classList.remove('active'), 2000);
        }

        function stopVoiceRecording() {
            isRecording = false;
            voiceInput.classList.remove('recording');
            voiceText.textContent = 'è¯­éŸ³å·²å½•åˆ¶';

            // Simulate AI processing
            aiTyping.classList.add('active');

            setTimeout(() => {
                // Show voice result
                const sampleText = "æˆ‘ä»¬éœ€è¦åœ¨ç§¯åˆ†æ–¹æ¡ˆAå’ŒBä¸­é€‰ä¸€ä¸ªï¼ŒAæ–¹æ¡ˆæ›´æ³¨é‡é•¿æœŸæ¿€åŠ±ï¼ŒBæ–¹æ¡ˆæ›´çµæ´»ã€‚å¤§å®¶çœ‹çœ‹å“ªä¸ªæ›´é€‚åˆæˆ‘ä»¬ç°åœ¨çš„é˜¶æ®µï¼Ÿ";
                voiceResult.textContent = sampleText;
                voiceResult.classList.add('active');

                // AI next question
                setTimeout(() => {
                    aiTyping.classList.remove('active');
                    aiQuestion.textContent = 'æ˜ç™½äº†ï¼éœ€è¦å›¢é˜Ÿåšä»€ä¹ˆï¼Ÿ';

                    // Show next step options
                    setTimeout(() => {
                        aiQuestion.textContent = 'AIå·²ä¸ºä½ æ„å»ºçŸ­é‚®ï¼Œè¦è¡¥å……é™„ä»¶å—ï¼Ÿ';

                        // Show preview
                        setTimeout(() => {
                            showPreview();
                        }, 1500);
                    }, 2000);
                }, 1500);
            }, 2000);
        }

        // Show preview
        function showPreview() {
            previewCard.classList.add('active');
            actionButtons.style.display = 'flex';

            // Update preview content
            document.getElementById('previewSubject').textContent = 'ç§¯åˆ†æ–¹æ¡ˆè®¨è®º';
            document.getElementById('previewActionType').textContent = 'ğŸ¯ éœ€è¦å†³ç­–';
            document.getElementById('previewContent').textContent =
                'æˆ‘ä»¬éœ€è¦åœ¨ç§¯åˆ†æ–¹æ¡ˆAå’ŒBä¸­é€‰ä¸€ä¸ªï¼ŒAæ–¹æ¡ˆæ›´æ³¨é‡é•¿æœŸæ¿€åŠ±ï¼ŒBæ–¹æ¡ˆæ›´çµæ´»ã€‚å¤§å®¶çœ‹çœ‹å“ªä¸ªæ›´é€‚åˆæˆ‘ä»¬ç°åœ¨çš„é˜¶æ®µï¼Ÿ';
        }

        // Quick actions
        document.querySelectorAll('.quick-action').forEach(action => {
            action.addEventListener('click', (e) => {
                const actionType = e.currentTarget.dataset.action;
                handleQuickAction(actionType);
                navigator.vibrate && navigator.vibrate(30);
            });
        });

        function handleQuickAction(type) {
            const messages = {
                photo: 'ğŸ“· å·²æ·»åŠ ç…§ç‰‡',
                file: 'ğŸ“ å·²æ·»åŠ æ–‡ä»¶',
                scan: 'ğŸ“„ æ‰«æå®Œæˆ'
            };

            gestureHint.textContent = messages[type];
            gestureHint.classList.add('active');

            // Add attachment to preview
            const attachmentHTML = `
                <div class="preview-attachment">
                    <span>${type === 'photo' ? 'ğŸ“·' : type === 'file' ? 'ğŸ“' : 'ğŸ“„'}</span>
                    <span>${type === 'photo' ? 'äº§å“æµç¨‹å›¾' : type === 'file' ? 'æ•°æ®åˆ†æ.xlsx' : 'æ‰«ææ–‡æ¡£.pdf'}</span>
                </div>
            `;
            document.getElementById('previewAttachments').innerHTML += attachmentHTML;

            setTimeout(() => gestureHint.classList.remove('active'), 2000);
        }

        // Edit button
        document.getElementById('editBtn').addEventListener('click', () => {
            gestureHint.textContent = 'å¯ä»¥ç»§ç»­è¯­éŸ³è¾“å…¥æˆ–æ·»åŠ é™„ä»¶';
            gestureHint.classList.add('active');
            setTimeout(() => gestureHint.classList.remove('active'), 2000);
        });

        // Send button
        document.getElementById('sendBtn').addEventListener('click', () => {
            // Show success animation
            successAnimation.classList.add('active');
            navigator.vibrate && navigator.vibrate([50, 100, 50]);

            setTimeout(() => {
                successAnimation.classList.remove('active');
                composeModal.classList.remove('active');

                // Add new mail to inbox (at top)
                const newMail = `
                    <div class="mail-card" style="animation: slideInUp 0.5s ease-out;">
                        <div class="mail-header">
                            <span class="mail-icon">ğŸ“Œ</span>
                            <span class="mail-title">ç§¯åˆ†æ–¹æ¡ˆè®¨è®º</span>
                            <span class="mail-badge">åˆšåˆšå‘é€</span>
                        </div>
                        <div class="mail-meta">ğŸ‘¤ ä½  â†’ è¿è¥èŠ‚ç‚¹ã€æŠ€æœ¯èŠ‚ç‚¹ â€¢ â±ï¸ åˆšåˆš</div>
                        <div class="mail-action">ğŸ¯ éœ€è¦å†³ç­–</div>
                        <div class="mail-attachments">
                            <span class="attachment-badge">ğŸ“ äº§å“æµç¨‹å›¾</span>
                            <span class="attachment-badge">ğŸ“Š æ•°æ®åˆ†æ</span>
                        </div>
                    </div>
                `;
                document.getElementById('inbox').insertAdjacentHTML('afterbegin', newMail);
            }, 1500);
        });

        // Click mail card to view detail
        document.getElementById('inbox').addEventListener('click', (e) => {
            const card = e.target.closest('.mail-card');
            if (card) {
                const mailId = card.dataset.id;
                if (mailId && mailDetails[mailId]) {
                    showMailDetail(mailDetails[mailId]);
                    navigator.vibrate && navigator.vibrate(30);
                }
            }
        });

        // Show mail detail
        function showMailDetail(mail) {
            detailModal.classList.add('active');

            const attachmentsHTML = mail.attachments.map(att => `
                <div class="attachment-item">
                    <div class="attachment-icon">${att.icon}</div>
                    <div class="attachment-info">
                        <div class="attachment-name">${att.name}</div>
                        <div class="attachment-desc">${att.desc}</div>
                    </div>
                </div>
            `).join('');

            document.getElementById('detailContent').innerHTML = `
                <div class="detail-subject">
                    <span>${mail.icon}</span>
                    <span>${mail.subject}</span>
                </div>

                <div class="detail-meta-grid">
                    <div class="detail-meta-item">
                        <div class="detail-meta-label">æ¥è‡ª</div>
                        <div class="detail-meta-value">${mail.from}</div>
                    </div>
                    <div class="detail-meta-item">
                        <div class="detail-meta-label">æ—¶é—´</div>
                        <div class="detail-meta-value">${mail.time}</div>
                    </div>
                    <div class="detail-meta-item">
                        <div class="detail-meta-label">è¡ŒåŠ¨ç‚¹</div>
                        <div class="detail-meta-value">${mail.actionType}</div>
                    </div>
                    <div class="detail-meta-item">
                        <div class="detail-meta-label">æœŸæœ›å“åº”</div>
                        <div class="detail-meta-value">4å°æ—¶å†…</div>
                    </div>
                </div>

                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>ğŸ’­</span>
                        <span>æ ¸å¿ƒå†…å®¹</span>
                    </div>
                    <div class="detail-text">${mail.content.replace(/\n/g, '<br>')}</div>
                </div>

                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>ğŸ“</span>
                        <span>é™„ä»¶ï¼ˆ${mail.attachments.length}ï¼‰</span>
                    </div>
                    <div class="attachment-list">
                        ${attachmentsHTML}
                    </div>
                </div>

                <div class="detail-section">
                    <div class="detail-section-title">
                        <span>ğŸ¤–</span>
                        <span>AIæ´å¯Ÿ</span>
                    </div>
                    <div class="detail-text">${mail.aiInsight.replace(/\n/g, '<br>')}</div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary">âŒ æ‹’ç»</button>
                    <button class="btn btn-primary">âœ… åŒæ„æ–¹æ¡ˆA</button>
                </div>
            `;
        }

        // Close detail modal
        detailBack.addEventListener('click', () => {
            detailModal.classList.remove('active');
        });

        // Swipe gestures on mail cards (simplified)
        let touchStartX = 0;
        let touchEndX = 0;

        document.getElementById('inbox').addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.getElementById('inbox').addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeDistance = touchEndX - touchStartX;
            if (Math.abs(swipeDistance) > 100) {
                if (swipeDistance > 0) {
                    // Swipe right - quick reply
                    gestureHint.textContent = 'ğŸ‘ˆ å·¦æ»‘å¿«é€Ÿå›å¤';
                } else {
                    // Swipe left - archive
                    gestureHint.textContent = 'ğŸ‘‰ å³æ»‘æŸ¥çœ‹è¯¦æƒ…';
                }
                gestureHint.classList.add('active');
                setTimeout(() => gestureHint.classList.remove('active'), 2000);
            }
        }
    </script>
</body>
</html>
